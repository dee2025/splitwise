\"use client\";\n\nimport { loginSuccess } from \"@/redux/slices/authSlice\";\nimport axios from \"axios\";\nimport { motion } from \"framer-motion\";\nimport { ArrowRight, Eye, EyeOff, Loader2, Lock, Mail, ChevronLeft } from \"lucide-react\";\nimport Link from \"next/link\";\nimport { useRouter } from \"next/navigation\";\nimport { useEffect, useState } from \"react\";\nimport toast from \"react-hot-toast\";\nimport { useDispatch, useSelector } from \"react-redux\";\n\nexport default function LoginPage() {\n  const router = useRouter();\n  const dispatch = useDispatch();\n  const { isAuthenticated } = useSelector((state) => state.auth);\n\n  const [form, setForm] = useState({ email: \"\", password: \"\" });\n  const [errors, setErrors] = useState({});\n  const [touched, setTouched] = useState({});\n  const [showPassword, setShowPassword] = useState(false);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n\n  useEffect(() => {\n    if (isAuthenticated) {\n      router.push(\"/dashboard\");\n    }\n  }, [isAuthenticated, router]);\n\n  const handleChange = (e) => {\n    const { name, value } = e.target;\n    setForm((prev) => ({ ...prev, [name]: value }));\n    if (errors[name]) {\n      setErrors((prev) => ({ ...prev, [name]: \"\" }));\n    }\n  };\n\n  const handleBlur = (e) => {\n    const { name } = e.target;\n    setTouched((prev) => ({ ...prev, [name]: true }));\n    validateField(name, form[name]);\n  };\n\n  const validateField = (name, value) => {\n    const newErrors = { ...errors };\n    switch (name) {\n      case \"email\":\n        if (!value.trim()) {\n          newErrors.email = \"Email is required\";\n        } else if (!/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(value)) {\n          newErrors.email = \"Invalid email address\";\n        } else {\n          delete newErrors.email;\n        }\n        break;\n      case \"password\":\n        if (!value) {\n          newErrors.password = \"Password is required\";\n        } else if (value.length < 6) {\n          newErrors.password = \"Password must be at least 6 characters\";\n        } else {\n          delete newErrors.password;\n        }\n        break;\n    }\n    setErrors(newErrors);\n  };\n\n  const handleLogin = async (e) => {\n    e.preventDefault();\n    setIsSubmitting(true);\n\n    try {\n      const res = await axios.post(\"/api/auth/login\", form);\n\n      if (res.data.success) {\n        dispatch(loginSuccess({ user: res.data.user }));\n        toast.success(res.data.message || \"Login successful\");\n        setTimeout(() => {\n          window.location.href = \"/dashboard\";\n        }, 500);\n      }\n    } catch (err) {\n      const errorMessage = err.response?.data?.error || \"Login failed\";\n      toast.error(errorMessage);\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  if (isAuthenticated) {\n    return (\n      <div className=\"min-h-screen bg-white flex items-center justify-center\">\n        <div className=\"text-center\">\n          <Loader2 className=\"w-8 h-8 animate-spin mx-auto mb-4 text-blue-600\" />\n          <p className=\"text-gray-600\">Redirecting...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 flex items-center justify-center px-4 sm:px-6 py-8 sm:py-12\">\n      {/* Back Button */}\n      <Link\n        href=\"/\"\n        className=\"absolute top-4 left-4 sm:top-6 sm:left-6 flex items-center gap-2 text-gray-600 hover:text-blue-600 transition-colors\"\n      >\n        <ChevronLeft className=\"w-5 h-5\" />\n        <span className=\"text-sm font-medium\">Back</span>\n      </Link>\n\n      {/* Main Container */}\n      <motion.div\n        initial={{ opacity: 0, y: 20 }}\n        animate={{ opacity: 1, y: 0 }}\n        transition={{ duration: 0.5 }}\n        className=\"w-full max-w-md\"\n      >\n        {/* Card */}\n        <div className=\"bg-white rounded-2xl shadow-lg border border-gray-100 p-6 sm:p-8 md:p-10\">\n          {/* Header */}\n          <div className=\"text-center mb-8 sm:mb-10\">\n            <Link href=\"/\" className=\"inline-block mb-6\">\n              <span className=\"text-2xl sm:text-3xl font-bold\">\n                Split<span className=\"bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent\">Wise</span>\n              </span>\n            </Link>\n            <h1 className=\"text-2xl sm:text-3xl font-bold text-gray-900 mb-2\">Welcome Back</h1>\n            <p className=\"text-gray-600 text-sm\">Sign in to your account to continue</p>\n          </div>\n\n          {/* Form */}\n          <form onSubmit={handleLogin} className=\"space-y-5 sm:space-y-6\">\n            {/* Email Field */}\n            <motion.div\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ delay: 0.1 }}\n            >\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                Email Address\n              </label>\n              <div className=\"relative\">\n                <Mail className=\"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400\" />\n                <input\n                  type=\"email\"\n                  name=\"email\"\n                  value={form.email}\n                  onChange={handleChange}\n                  onBlur={handleBlur}\n                  placeholder=\"you@example.com\"\n                  className={`w-full pl-10 pr-4 py-3 rounded-lg border-2 transition-all focus:outline-none ${\n                    touched.email && errors.email\n                      ? \"border-red-500 bg-red-50\"\n                      : \"border-gray-200 bg-gray-50 focus:border-blue-500 focus:bg-white\"\n                  }`}\n                />\n              </div>\n              {touched.email && errors.email && (\n                <p className=\"text-red-600 text-sm mt-2\">{errors.email}</p>\n              )}\n            </motion.div>\n\n            {/* Password Field */}\n            <motion.div\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ delay: 0.2 }}\n            >\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                Password\n              </label>\n              <div className=\"relative\">\n                <Lock className=\"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400\" />\n                <input\n                  type={showPassword ? \"text\" : \"password\"}\n                  name=\"password\"\n                  value={form.password}\n                  onChange={handleChange}\n                  onBlur={handleBlur}\n                  placeholder=\"••••••••\"\n                  className={`w-full pl-10 pr-10 py-3 rounded-lg border-2 transition-all focus:outline-none ${\n                    touched.password && errors.password\n                      ? \"border-red-500 bg-red-50\"\n                      : \"border-gray-200 bg-gray-50 focus:border-blue-500 focus:bg-white\"\n                  }`}\n                />\n                <button\n                  type=\"button\"\n                  onClick={() => setShowPassword(!showPassword)}\n                  className=\"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors\"\n                >\n                  {showPassword ? <EyeOff className=\"w-5 h-5\" /> : <Eye className=\"w-5 h-5\" />}\n                </button>\n              </div>\n              {touched.password && errors.password && (\n                <p className=\"text-red-600 text-sm mt-2\">{errors.password}</p>\n              )}\n            </motion.div>\n\n            {/* Forgot Password Link */}\n            <div className=\"flex justify-end\">\n              <Link\n                href=\"/forgot-password\"\n                className=\"text-sm text-blue-600 hover:text-blue-700 font-medium transition-colors\"\n              >\n                Forgot password?\n              </Link>\n            </div>\n\n            {/* Submit Button */}\n            <motion.button\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ delay: 0.3 }}\n              whileHover={{ scale: 1.02 }}\n              whileTap={{ scale: 0.98 }}\n              type=\"submit\"\n              disabled={isSubmitting}\n              className=\"w-full py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg font-semibold hover:shadow-lg transition-all disabled:opacity-60 disabled:cursor-not-allowed flex items-center justify-center gap-2 mt-8\"\n            >\n              {isSubmitting ? (\n                <>\n                  <Loader2 className=\"w-4 h-4 animate-spin\" />\n                  <span>Signing in...</span>\n                </>\n              ) : (\n                <>\n                  <span>Sign In</span>\n                  <ArrowRight className=\"w-4 h-4\" />\n                </>\n              )}\n            </motion.button>\n          </form>\n\n          {/* Divider */}\n          <div className=\"my-6 flex items-center gap-3\">\n            <div className=\"flex-1 h-px bg-gray-200\" />\n            <span className=\"text-sm text-gray-500\">New to SplitWise?</span>\n            <div className=\"flex-1 h-px bg-gray-200\" />\n          </div>\n\n          {/* Signup Link */}\n          <p className=\"text-center text-gray-600 text-sm\">\n            Create an account{\" \"}\n            <Link\n              href=\"/signup\"\n              className=\"text-blue-600 font-semibold hover:text-blue-700 transition-colors\"\n            >\n              Sign up here\n            </Link>\n          </p>\n        </div>\n\n        {/* Footer Info */}\n        <p className=\"text-center text-xs text-gray-500 mt-6 sm:mt-8\">\n          By signing in, you agree to our{\" \"}\n          <Link href=\"#terms\" className=\"text-blue-600 hover:underline\">\n            Terms of Service\n          </Link>\n          {\" \"}and{\" \"}\n          <Link href=\"#privacy\" className=\"text-blue-600 hover:underline\">\n            Privacy Policy\n          </Link>\n        </p>\n      </motion.div>\n    </div>\n  );\n}\n